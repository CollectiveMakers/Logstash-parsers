FORTIDATE %{YEAR}-%{MONTHNUM}-%{MONTHDAY}

#FORTIGATE_P1 ^\<%{POSINT:syslog_id}\>date=%{FORTIDATE:forti_date} time=%{TIME:forti_time} devname=%{HOSTNAME:hostname} (device_id|devid)=%{HOSTNAME:serial_number} (logid|log_id)=%{NUMBER:log_id} type=%{DATA:log_type} subtype=%{DATA:log_subtype} (eventtype=%{DATA:forti_event_type} )?(level|pri)=%{WORD:pri}( vd=(\")?%{WORD:vdom}(\")?)?( urlfilteridx=%{INT:forti_urlfilteridx} urlfilterlist=(\")?%{DATA:forti_urlfilterlist}(\")?)? (logdesc=\"%{DATA:log_desc}\" (interface=(\")?%{HOSTNAME:interface}(\")? dhcp_msg=(\")?%{DATA:dhcp_msg}(\")? dir=%{DATA:dir} mac=%{MAC:mac} ip=%{IP:ip} lease=%{INT:lease} hostname=\"%{HOSTNAME:src_host}\" |server=%{IP:server} action=%{DATA:action} )msg=\"%{DATA:msg}\"|(srcip|src)=%{IP:src_ip}( (srcport|src_port)=%{INT:src_port})? (srcintf|src_int)=(\")?%{HOSTNAME:src_interface}(\")? (dstip|dst)=%{IP:dst_ip}( (dstport|dst_port)=%{INT:dst_port})?( (dstintf|dst_int)=(\")?%{HOSTNAME:dst_interface}(\")?)?( poluuid=%{UUID:pol_uuid})? (sessionid|SN)=%{INT:session_id} (action|status)=%{DATA:action} policyid=%{INT:policy_id}( (dstcountry|dst_country)=\"%{DATA:dst_country}\" (srccountry|src_country)=\"%{DATA:src_country}\" (trandisp=%{WORD:trandisp} )?(service=\"%{INT:service_port}\/%{WORD:service}\"|service=%{DATA:service}) proto=%{INT:proto} duration=%{INT:duration:int} (sentbyte|sent)=%{INT:bytes_sent:int} (rcvdbyte|rcvd)=%{INT:bytes_received:int}( sentpkt=%{INT:packets_sent:int} rcvdpkt=%{INT:packets_received:int})?)?( crscore=%{INT:crscore:int} craction=%{INT:craction:int})?|sessionid=%{INT:sessionid} (srcip|src)=%{IP:src_ip} (srcport|src_port)=%{INT:src_port} (dstip|dst)=%{IP:dst_ip} (dstport|dst_port)=%{INT:dst_port} proto=%{INT:proto} service=%{WORD:service} hostname=\"%{HOSTNAME:src_host}\" profile=\"%{WORD:profile}\" action=%{DATA:action} reqtype=%{WORD:reqtype} url=\"%{DATA:url}\" sentbyte=%{INT:bytes_sent:int} rcvdbyte=%{INT:bytes_received:int} direction=%{WORD:direction} msg=\"%{DATA:msg}\")

#FORTIGATE_P2 ^\<%{POSINT:syslog_id}\>date=%{FORTIDATE:forti_date} time=%{TIME:forti_time} devname=%{HOSTNAME:hostname} (device_id|devid)=%{HOSTNAME:serial_number} (logid|log_id)=%{NUMBER:log_id} type=%{DATA:log_type} subtype=%{DATA:log_subtype} (eventtype=%{DATA:forti_event_type} )?(level|pri)=%{WORD:pri}( vd=(?:\")?%{WORD:vdom}(?:\")?)?(?: urlfilteridx=%{INT:forti_urlfilteridx} urlfilterlist=(\")?%{DATA:forti_urlfilterlist}(\")?)? srcip=%{IP:src_ip} (?:srcport=%{POSINT:src_port} )?srcintf=(?:\")?%{DATA:src_interface}(?:\")? dstip=%{IP:dst_ip} (?:dstport=%{POSINT:dst_port} )?dstintf=(?:\")%{DATA:dst_interface}(?:\")(?: poluuid=%{UUID:pol_uuid})? sessionid=%{POSINT:session_id} proto=%{NUMBER:proto} action=%{DATA:action} policyid=%{NUMBER:policy_id} (?:policytype=%{DATA:policy_type} )?(?:dstcountry=(?:\")?%{DATA:dst_country}(?:\")? )?(?:srccountry=(?:\")%{DATA:src_country}(?:\")? )?(?:trandisp=%{WORD:trandisp} )?(?:transip=%{IP:transip} )?(?:transport=%{NUMBER:transport} )?(?:service=(?:\")?%{DATA:service}(?:\")? )?(?:app=\"%{DATA:app}\" )?(?:duration=%{INT:duration:int} )?(?:sentbyte=%{INT:bytes_sent:int} )?(?:rcvdbyte=%{INT:bytes_received:int} )?(?:sentpkt=%{INT:packets_sent:int} )?(?:rcvdpkt=%{INT:packets_received:int} )?(?:appcat=\"%{DATA:app_category}\"(?: )?)?(?:crscore=%{INT:crscore} craction=%{INT:craction} crlevel=%{WORD:crlevel})?

FORTIGATE_P1 ^\<%{INT:syslog_id}\>date=%{FORTIDATE:forti_date} time=%{TIME:forti_time} devname=%{HOSTNAME:hostname} (?:device_id|devid)=%{HOSTNAME:serial_number} (?:logid|log_id)=%{NUMBER:log_id} type=%{DATA:log_type} subtype=%{DATA:log_subtype} (?:eventtype=%{DATA:forti_event_type} )?(?:level|pri)=%{WORD:pri}(?: vd=(\")?%{WORD:vdom}(\")?)?(?: urlfilteridx=%{INT:forti_urlfilteridx} urlfilterlist=(\")?%{DATA:forti_urlfilterlist}(\")?)? (?:logdesc=\"%{DATA:log_desc}\" (?:interface=(\")?%{HOSTNAME:interface}(\")? dhcp_msg=(\")?%{DATA:dhcp_msg}(\")? dir=%{DATA:dir} mac=%{MAC:mac} ip=%{IP:ip} lease=%{INT:lease} hostname=\"%{HOSTNAME:src_host}\" |server=%{IP:server} action=%{DATA:action} )msg=\"%{DATA:msg}\"|(?:srcip|src)=%{IP:src_ip}(?: (?:srcport|src_port)=%{INT:src_port})? (?:srcintf|src_int)=(?:\")?%{HOSTNAME:src_interface}(?:\")? (?:dstip|dst)=%{IP:dst_ip}(?: (?:dstport|dst_port)=%{INT:dst_port})?(?: (?:dstintf|dst_int)=(?:\")?%{HOSTNAME:dst_interface}(?:\")?)?(?: poluuid=%{UUID:pol_uuid})? (?:sessionid|SN)=%{INT:session_id} (?:action|status)=%{DATA:action} policyid=%{INT:policy_id}(?: (?:dstcountry|dst_country)=\"%{DATA:dst_country}\" (?:srccountry|src_country)=\"%{DATA:src_country}\" (?:(?:(?:dirdisp|dir_disp)=%{WORD:dirdisp} )?(?:trandisp|tran_disp)=%{WORD:trandisp} (?:tranip=%{IP:nat_dst_ip} )?(?:transip=%{IP:nat_src_ip} )?(?:tranport=%{NUMBER:nat_dst_port} )?(?:transport=%{NUMBER:nat_src_port} )?)?(?:service=\"%{INT:service_port}\/%{WORD:service}\"|service=%{DATA:service}) proto=%{INT:proto} duration=%{INT:duration:int} (?:sentbyte|sent)=%{INT:bytes_sent:int} (?:rcvdbyte|rcvd)=%{INT:bytes_received:int}(?: (?:sentpkt|sent_pkt)=%{INT:packets_sent:int})?(?: (?:rcvdpkt|rcvd_pkt)=%{INT:packets_received:int})?)?(?: crscore=%{INT:crscore:int}(?: craction=%{INT:craction:int})?)?|sessionid=%{INT:sessionid} (?:srcip|src)=%{IP:src_ip} (?:srcport|src_port)=%{INT:src_port} (?:dstip|dst)=%{IP:dst_ip} (?:dstport|dst_port)=%{INT:dst_port} proto=%{INT:proto} service=%{WORD:service} hostname=\"%{HOSTNAME:src_host}\" profile=\"%{WORD:profile}\" action=%{DATA:action} reqtype=%{WORD:reqtype} url=\"%{DATA:url}\" (?:sentbyte|sent)=%{INT:bytes_sent:int} (?:rcvdbyte|rcvd)=%{INT:bytes_received:int} direction=%{WORD:direction} msg=\"%{DATA:msg}\")

FORTIGATE_P2 ^\<%{INT:syslog_id}\>date=%{FORTIDATE:forti_date} time=%{TIME:forti_time} devname=%{HOSTNAME:hostname} (?:device_id|devid)=%{HOSTNAME:serial_number} (?:logid|log_id)=%{NUMBER:log_id} type=%{DATA:log_type} subtype=%{DATA:log_subtype}(?: eventtype=%{DATA:forti_event_type})? (?:level|pri)=%{WORD:pri}(?: vd=(?:\")?%{WORD:vdom}(?:\")?)?(?: urlfilteridx=%{INT:forti_urlfilteridx} urlfilterlist=(\")?%{DATA:forti_urlfilterlist}(\")?)? (?:srcip|src)=%{IP:src_ip}(?: (?:srcport|src_port)=%{INT:src_port})? (?:srcintf|src_int)=(?:\")?%{DATA:src_interface}(?:\")? (?:dstip|dst)=%{IP:dst_ip}(?: (?:dstport|dst_port)=%{INT:dst_port})? (?:dstintf|dst_int)=(?:\")%{DATA:dst_interface}(?:\")(?: poluuid=%{UUID:pol_uuid})? sessionid=%{INT:session_id}(?: proto=%{NUMBER:proto})? action=%{DATA:action} policyid=%{NUMBER:policy_id}(?: policytype=%{DATA:policy_type})?(?: (?:dstcountry|dst_country)=\"%{DATA:dst_country}\")?(?: (?:srccountry|src_country)=\"%{DATA:src_country}\")?(?:(?: (?:dirdisp|dir_disp)=%{WORD:dirdisp})? (?:trandisp|tran_disp)=%{WORD:trandisp}(?: tranip=%{IP:nat_dst_ip})?(?: transip=%{IP:nat_src_ip})?(?: tranport=%{NUMBER:nat_dst_port})?(?: transport=%{NUMBER:nat_src_port})?)?(?: service=\"%{DATA:service}\")?(?: proto=%{NUMBER:proto})?(?: app=\"%{DATA:app}\")?(?: duration=%{INT:duration:int})?(?: (?:sentbyte|sent)=%{INT:bytes_sent:int})?(?: (?:rcvdbyte|rcvd)=%{INT:bytes_received:int})?(?: (?:sentpkt|sent_pkt)=%{INT:packets_sent:int})?(?: (?:rcvdpkt|rcvd_pkt)=%{INT:packets_received:int})?(?: appcat=\"%{DATA:app_category}\")?(?: crscore=%{INT:crscore}(?: craction=%{INT:craction})? crlevel=%{WORD:crlevel})?

FORTIGATE_WAN_OPT_APP_TYPE ^\<%{INT:syslog_id}\>date=%{FORTIDATE:forti_date} time=%{TIME:forti_time} devname=%{HOSTNAME:hostname} (?:device_id|devid)=%{HOSTNAME:serial_number} (?:logid|log_id)=%{NUMBER:log_id} type=%{DATA:log_type} subtype=%{DATA:log_subtype} (?:level|pri)=%{WORD:pri} vd=(?:\")?%{WORD:vdom}(?:\")? (?:srcip|src)=%{IP:src_ip} srcport=%{INT:src_port} (?:srcintf|src_int)=(?:\")?%{DATA:src_interface}(?:\")? dstip=%{IP:dst_ip} (?:dstport|dst_port)=%{INT:dst_port} (?:dstintf|dst_int)=(?:\")%{DATA:dst_interface}(?:\") sessionid=%{INT:session_id} poluuid=%{UUID:pol_uuid} (?:dstcountry|dst_country)=\"%{DATA:dst_country}\" (?:srccountry|src_country)=(?:\")%{DATA:src_country}(?:\")? service=(?:\")?%{DATA:service}(?:\")? wanoptapptype=%{DATA:wan_opt_app_type} proto=%{NUMBER:proto} duration=%{INT:duration:int} policyid=%{NUMBER:policy_id} wanin=%{INT:wan_in:int} (?:rcvdbyte|rcvd)=%{INT:bytes_received:int} wanout=%{INT:wan_out:int} lanin=%{INT:lan_in:int} sentbyte=%{INT:bytes_sent:int} lanout=%{INT:lan_out:int} appcat=\"%{DATA:app_category}\"

FORTIGATE_UTM ^\<%{INT:syslog_id}\>date=%{FORTIDATE:forti_date} time=%{TIME:forti_time} devname=%{HOSTNAME:hostname} (?:device_id|devid)=%{HOSTNAME:serial_number} (?:logid|log_id)=%{NUMBER:log_id} type=%{DATA:log_type} subtype=%{DATA:log_subtype} (?:eventtype=%{DATA:forti_event_type} )?(?:level|pri)=%{WORD:pri} vd=(?:\")?%{WORD:vdom}(?:\")?(?: urlfilteridx=%{INT:forti_urlfilteridx})? sessionid=%{INT:session_id} user=\"%{DATA:user_name}\" (?:srcip|src)=%{IP:src_ip} srcport=%{INT:src_port} (?:srcintf|src_int)=(?:\")?%{DATA:src_interface}(?:\")? dstip=%{IP:dst_ip} (?:dstport|dst_port)=%{INT:dst_port} (?:dstintf|dst_int)=(?:\")%{DATA:dst_interface}(?:\") proto=%{NUMBER:proto} service=(?:\")?%{DATA:service}(?:\")? hostname=\"%{DATA:dst_host}\" profile=\"%{DATA:profile}\" action=%{DATA:action} reqtype=%{WORD:reqtype} url=\"%{URIPATH:url}\" sentbyte=%{INT:bytes_sent:int} (?:rcvdbyte|rcvd)=%{INT:bytes_received:int} direction=%{WORD:direction} msg=\"%{DATA:msg}\"(?: method=%{WORD:forti_http_method} cat=%{INT:forti_web_cat_id} catdesc=\"%{DATA:forti_web_cat_desc}\")?(?: crscore=%{INT:crscore} crlevel=%{WORD:crlevel})?

FORTIGATE_GENERIC_PATTERN ^\<%{POSINT:syslog_id}\>date=%{FORTIDATE:forti_date} time=%{TIME:forti_time} devname=%{HOSTNAME:hostname} (devid|device_id)=%{HOSTNAME:serial_number} (logid|log_id)=%{NUMBER:log_id} type=%{DATA:log_type} subtype=%{DATA:log_subtype} (?:level|pri)=%{WORD:pri} vd=(?:\")?%{WORD:vdom}(?:\")? %{GREEDYDATA:end_of_message}
